<!-- SHOW BANNER -->
<% if @spot.photo %>
  <% img_url = cl_image_path @spot.photo.path, :width => 1600, :height => 700, :crop => :fill,
             :gravity => :south %>
<% else %>
  <% img_url = "http://res.cloudinary.com/dmx5zou5e/image/upload/c_crop,g_custom,h_700,w_1600,x_922,y_559/v1480531988/image1_henvzi.jpg"%>
<% end %>
<div class="banner banner-show" style="background-image: linear-gradient(rgba(201, 255, 191, 0.2), rgba(255, 175, 189, 0.2)),
         url('<%= img_url %>')">
  <h1 id="spot-show-h1-title"><%= @spot.name.capitalize %>

    <% if @spot.average_rating %>
      <div id="spot-rating">
        <% @spot.average_rating.round.times do %>
          <i class="fa fa-star yellow-filled"></i>
        <% end %>
        <% (5 - @spot.average_rating.round).times do %>
          <i class="fa fa-star-o"></i>
        <% end %>
      </div>
    <% end %>
    <%= link_to favorite_spots_path(spot_id: params[:id]), method: :post, id: "add-to-favorite-btn", class: "kite-round-btn" do %>
      <i class="fa fa-heart"></i>
    <% end %>

    </h1>

  <div class="tabs">
    <a class="tab active" href="#" id="tab_weather">
      <p>WEATHER</p>
    </a>
    <a class="tab" href="#" id="tab_infos">
      <p>INFOS</p>
    </a>
    <a class="tab" href="#" id="tab_reviews">
      <p>REVIEWS</p>
    </a>
  </div>
</div>

<div class="wrapper">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">


        <!-- Content for Infos section -->
        <div class="content hidden" id="content_for_infos">
          <!-- Title Section -->
          <div class="col-xs-12">
            <div class="spot-show-card">
              <%= render 'h2_title', title: "Description"%>
              <p><%= @spot.description unless @spot.description.nil?%></p>
            </div>
          </div>

          <!-- Facilities -->
          <div class="col-xs-12">
            <div class="spot-show-card">
              <%= render 'h2_title', title: "Facilities"%>

              <% unless @spot.facility.nil? %>
                <% unless @spot.facility[:parking].nil? %><p><strong>Parking:</strong> <%= @spot.facility[:parking] %></p><% end %>
                <% unless @spot.facility[:safety_watch].nil? %><p><strong>Sécurité: <%= @spot.facility[:safety_watch] %></p><% end %></strong>
                <% unless @spot.facility[:kite_school].nil? %><p><strong>Ecoles:</strong> <%= @spot.facility[:kite_school] %></p><% end %>
                <% unless @spot.facility[:water_spot].nil? %><p><strong>Point d'eau:</strong> <%= @spot.facility[:water_spot] %></p><% end %>
                <% unless @spot.facility[:shop].nil? %><p><strong>Shop:</strong> <%= @spot.facility[:shop] %></p><% end %>
                <% unless @spot.facility[:shower].nil? %><p><strong>Douches:</strong> <%= @spot.facility[:shower] %></p><% end %>
                <% unless @spot.facility[:comment].nil? %><p><strong>Commentaires:</strong> <%= @spot.facility[:comment] %></p><% end %>
              <% else %>
                <p>No facilities added for this spot</p>
              <% end %>
            </div>
          </div>
        </div>

        <!-- End of content for Infos section -->


        <!-- Content for Reviews section -->
        <div class="content hidden" id="content_for_reviews">
          <div class="col-xs-12 col-sm-12 col-md-12">
            <div class="spot-show-card">
              <h2 id="reviews_count">
                <%= render "spots/reviews_count", spot: @spot %>
              </h2>

              <!-- Modal for reviews -->
              <!-- btn btn-primary btn-lg -->
              <% if user_signed_in? %>
                <button type="button" class="kite-std-btn" data-toggle="modal" data-target="#myModalReview" id="comment-button">
                  Add a review
                </button>
              <% else %>
                <%= link_to "Sign in and had a review", new_user_session_path, class: "kite-std-btn"%>
              <% end %>
            </div>
            <hr>
            <div class="spot-show-card" id="reviews">
              <% @spot.reviews.each do |review| %>
               <%= render 'reviews/show', review: review %>
              <% end %>
            </div>
          </div>
        </div>
        <!-- End of content for Reviews section -->


        <!-- Content for Weather section -->
        <div class="content" id="content_for_weather">
          <!-- Weather infos -->
          <div class="col-xs-12">
            <div class="recommendation text-center">
              <h2><i class="fa fa-sun-o" aria-hidden="true"></i></h2>
              <h2>17°C</h2>
              <h2>Take your 4.2 Wing and go for it</h2>
            </div>
            <div class="spot-show-card">
              <%= render 'h2_title', title: "Weather forecast"%>
              <%= render 'forecast', forecasts: nil %>
            </div>
          </div>

          <!-- Tide infos -->
          <div class="col-xs-12 col-sm-6" id="tide-container">
            <div class="spot-show-card">
              <div class="tide-data hidden">
                <%= render 'h2_title', title: "Tide forecast"%>
                <% query = @spot.harbor.query if @spot.harbor %>
                <% query = "ABER_BENOIT_MEAN_RENEAT" if !@spot.harbor #TEST PURPOSES, line to be delted%>
                <script src="http://services.data.shom.fr/hdm/vignette/petite/<%= query %>?locale=fr"></script>
              </div>
            </div>
          </div>
          <!-- Feedback infos -->
          <div class="col-xs-12 col-sm-6" id='feedbacks-container'>
            <div class="spot-show-card">
              <%= render 'h2_title', title: "Weather feedback"%>
              <%= render 'weather_feedbacks', feedbacks: @spot.weather_feedbacks %>

              <% if user_signed_in? %>
                <button type="button" class="kite-std-btn" data-toggle="modal" data-target="#myModal" id="comment-button">
                  Add a weather feedback
                </button>
              <% else %>
                <%= link_to "Sign in and had a review", new_user_session_path, class: "kite-std-btn"%>
              <% end %>
            </div>
          </div>



        </div>

        <!-- End of content for Weather section -->




        <!-- Review Modal -->
          <div class="modal fade" id="myModalReview" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">Review</h4>
                </div>
                <div class="modal-body" id="review_form_container">
                  <%= render 'reviews/form', spot: @spot, review: @review %>
                </div>
                <div class="modal-footer">
                  <button type="button" class="kite-std-btn" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>

           <!-- Weather feedbacks Modal -->
          <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">Weather feedback</h4>
                </div>
                <div class="modal-body" id="review_form_container">
                  <%= render 'weather_feedbacks/form', spot: @spot, feedback: @feedback %>
                </div>
                <div class="modal-footer">
                  <button type="button" class="kite-std-btn" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>

        <!-- End of features -->

      </div>
    </div>
  </div>
</div>

